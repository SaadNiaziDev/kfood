---
import type { ImageMetadata } from "astro";

interface Props {
	title: string;
	excerpt: string;
	date: string;
	category: string;
	imageUrl?: string;
	class?: string;
	image?: ImageMetadata;
}

const { title, excerpt, date, category, imageUrl, class: className = "", image } = Astro.props;

const imageSrc = image?.src;
const imageAlt = title;
---

<div class={`news-card w-full h-full flex flex-col overflow-hidden rounded-card shadow-md ${className}`}>
	<div
		class='news-card__image w-full shrink-0 overflow-hidden flex items-center justify-center bg-kfood-primary'
		style='aspect-ratio: 4/3'>
		{
			imageSrc ? (
				<img src={imageSrc} alt={imageAlt} class='w-full h-full object-cover' loading='lazy' decoding='async' />
			) : (
				<div class='text-white/60 text-5xl'>ðŸ“°</div>
			)
		}
	</div>
	<div class='news-card__content flex-1 flex flex-col min-h-0 bg-white px-4 pt-4 pb-5'>
		<span
			class='inline-block px-3 py-1 rounded-[20px] text-white mb-2.5 bg-accent-orange font-heading font-medium text-[14px] leading-none shrink-0 w-fit'>
			{category}
		</span>
		<h3 class='mb-1.5 font-heading font-semibold text-[15px] leading-[20px] text-kfood-primary line-clamp-2'>
			{title}
		</h3>
		<p class='mb-3 font-body text-[13px] leading-[19px] text-muted line-clamp-4 flex-1 min-h-0'>
			{excerpt}
		</p>
		<p class='flex items-center gap-2 text-[12px] leading-[14px] font-body text-muted shrink-0'>
			<svg
				class='shrink-0 w-3.5 h-3.5 text-kfood-primary'
				viewBox='0 0 24 24'
				fill='none'
				stroke='currentColor'
				stroke-width='1.6'
				stroke-linecap='round'
				stroke-linejoin='round'
				aria-hidden='true'>
				<rect x='3' y='4' width='18' height='18' rx='2' ry='2'></rect>
				<line x1='16' y1='2' x2='16' y2='6'></line>
				<line x1='8' y1='2' x2='8' y2='6'></line>
				<line x1='3' y1='10' x2='21' y2='10'></line>
			</svg>
			<span>{date}</span>
		</p>
	</div>
</div>

<style>
	.news-card__content h3,
	.news-card__content p:not(:last-of-type) {
		display: -webkit-box;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
	.news-card__content h3 {
		-webkit-line-clamp: 2;
	}
	.news-card__content p:not(:last-of-type) {
		-webkit-line-clamp: 4;
	}
</style>
